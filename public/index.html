<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/d3/d3.js"></script>
    <script src="js/ui.js"></script>

</head>
<body>
<input type="text" id="new-dot"/>
<button onclick="nyPrick($('#new-dot').val());$('#new-dot').val('');">Ny prick</button>
<script>

    var width = 800,
            height = 800,
            radius = 10;

    var drag =  d3.behavior.drag()
            .on("drag", dragmove);


    var svg = d3.select("body").append("div").selectAll("svg")
            .data(d3.range(1).map(function() { return {x: width / 2, y: height / 2}; }))
            .enter().append("svg")
            .attr("width", width)
            .attr("height", height);

    function buildRadar(){
        for(var i = 100; i < 500; i += 100){
            svg.append("circle")
                    .attr("r", i)
                    .attr("cx", function(d) { return width / 2; })
                    .attr("cy", function(d) { return height / 2; })
                    .attr("fill","transparent")
                    .attr("stroke","#ccc");
        }
    }

    function buildCrossHair(){
        svg.append("line")
                .attr("x1",  width / 2 )
                .attr("x2",  width / 2)
                .attr("y1", height)
                .attr("y2", 0)
                .attr("stroke","#ccc");
        svg.append("line")
                .attr("x1",  0 )
                .attr("x2",  width)
                .attr("y1", height / 2)
                .attr("y2", height / 2)
                .attr("stroke","#ccc");
    }

    function dragmove(d) {

        d3.select(this).selectAll("circle")
                .attr("cx", d.x = Math.max(radius, Math.min(width - radius, d3.event.x)))
                .attr("cy", d.y = Math.max(radius, Math.min(height - radius, d3.event.y)));
        d3.select(this).selectAll("text")
                .attr("x", d.x = Math.max(radius, Math.min(width - radius, d3.event.x)))
                .attr("y", d.y = Math.max(radius, Math.min(height - radius, d3.event.y)));
    }

    function nyPrick(text){

        var g = svg.append("g").call(drag);

        g.append("circle")
                .attr("r", radius)
                .attr("cx", function(d) { return width / 2; })
                .attr("cy", function(d) { return height / 2; })
                .attr("fill","#ccc")
                .attr("stroke","#ccc");

        g.append("text")
            .attr("x", function(d) { return width / 2; })
            .attr("y", function(d) { return height / 2; })
            .text(text);

    }

    buildRadar();
    buildCrossHair();
</script>
</body>
</html>